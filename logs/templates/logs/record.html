<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>MediQuest - Quest Board</title>
    <style>
        body { font-family: 'Courier New', Courier, monospace; background-color: #1a1a1a; color: #eee; padding: 20px; }
        .card-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
        .card { background: #333; border: 2px solid #555; border-radius: 10px; overflow: hidden; text-align: center; position: relative; }
        
        /* ç”»åƒã‚¨ãƒªã‚¢ */
        .enemy-img-container { height: 120px; background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .enemy-img { width: 100%; height: 100%; object-fit: contain; }
        
        .hp-bar-bg { background: #555; height: 10px; width: 100%; }
        .hp-bar-fill { background: #ff5252; height: 100%; transition: width 0.5s; }
        .clear-bar { background: #ffd700 !important; } /* 100%ã§é‡‘è‰²ã« */
        
        .card-info { padding: 10px; }
        .clear-badge { position: absolute; top: 5px; right: 5px; background: gold; color: black; padding: 2px 5px; font-size: 10px; font-weight: bold; border-radius: 3px; }
        
        /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ç°¡æ˜“ã‚¹ã‚¿ã‚¤ãƒ« */
        .form-section { background: #222; padding: 20px; border-radius: 10px; margin-bottom: 30px; border: 1px solid #444; }
        input, select { margin: 5px; padding: 5px; }
        button { background: #e74c3c; color: white; border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>

    <h1>ğŸ”¥ MediQuest - å‹‡è€… {{ user.username }} ã®å†’é™º ğŸ”¥</h1>

    <div class="form-section">
        <h3>ğŸ“ ã‚¯ã‚¨ã‚¹ãƒˆã‚’è¨˜éŒ²ã™ã‚‹</h3>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">çµŒé¨“å€¤ã‚’ç²å¾—ï¼</button>
        </form>
    </div>

    <hr>

    <h3>ğŸ‘¾ å‡ºç¾ä¸­ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ (ç§‘ç›®ä¸€è¦§)</h3>
    <div class="card-container">
        {% for status in subject_status_list %}
        <div class="card">
            {% if status.video_progress >= 100 %}
                <div class="clear-badge">ğŸ† DEFEATED</div>
            {% endif %}

            <div class="enemy-img-container">
                {% if status.image_url %}
                    <img src="{{ status.image_url }}" class="enemy-img">
                {% else %}
                    <div style="font-size: 50px;">ğŸ‘¾</div>
                {% endif %}
            </div>

            <div class="hp-bar-bg">
                <div class="hp-bar-fill {% if status.video_progress >= 100 %}clear-bar{% endif %}" style="width: {{ status.video_progress }}%;"></div>
            </div>

            <div class="card-info">
                <strong>{{ status.name }}</strong><br>
                <small>Progress: {{ status.video_progress }}%</small><br>
                <small>({{ status.current_val }} / {{ status.total_val }} æœ¬)</small>
            </div>
        </div>
        {% endfor %}
    </div>

    <p style="margin-top: 50px;"><a href="{% url 'logout' %}" style="color: #888;">å†’é™ºã‚’ä¸€æ™‚ä¸­æ–­ã™ã‚‹ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰</a></p>

</body>
</html>